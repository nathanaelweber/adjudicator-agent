# Refactoring-Tasks: Optimierung der Quieszenz-Suche

Die folgenden Tasks dienen der Optimierung der `quiescence`-Methode in `src/main/java/ch/adjudicator/agent/BestMoveCalculator.java`. Ziel ist es, die Rechenzeit zu verkürzen, indem die Zuggenerierung von allen legalen Zügen auf die direkte Generierung von **nur** lauten Zügen (Captures und Promotions) umgestellt wird, idealerweise unter Nutzung von Bitboard-basierten Methoden der `chesslib` Bibliothek.

| Task-ID | Titel | Beschreibung | Priorität |
| :---: | :--- | :--- | :---: |
| **QS-01** | **Analyse: Optimierte Zuggenerierung in `chesslib`** | Untersuchen Sie die API der verwendeten Bibliothek (`com.github.bhlangonijr.chesslib.Board`) auf Methoden, die es ermöglichen, **nur** Schlagzüge (Captures) und Promotionen zu generieren. Viele High-Performance-Bibliotheken bieten hierfür spezialisierte Bitboard-basierte Funktionen (z.B. `board.legalCaptures()`). | Hoch |
| **QS-02** | **Refactoring: Direkte Generierung lauter Züge in `quiescence`** | Ersetzen Sie in der Methode `quiescence(int alpha, int beta, int ply, Board searchBoard)` die folgenden Zeilen: <br> `List<Move> moves = searchBoard.legalMoves();`<br>`List<Move> noisy = new ArrayList<>();`<br>`for (Move m : moves) { if (isCapture(m, searchBoard) || isPromotion(m)) noisy.add(m); }`<br> durch einen direkten Aufruf, der nur die **lauten Züge** (`noisy` moves) liefert. | Hoch |
| **QS-03** | **Bereinigung: Entfernung redundanter Hilfsmethoden** | Überprüfen Sie, ob die Methoden `isCapture(Move m, Board searchBoard)` und `isPromotion(Move m)` nach der Umstellung noch benötigt werden, da eine optimierte Generierung diese Überprüfung bereits implizit vornimmt. Entfernen Sie diese, falls sie nur noch in der `quiescence`-Methode verwendet wurden. | Mittel |
| **QS-04** | **Test: Performance-Validierung** | Erstellen Sie einen Micro-Benchmark (z.B. mit JMH oder einem einfachen Zeitstopp in `BestMoveCalculatorTest.java`) für einen tiefen `quiescence`-Aufruf in einer komplexen Position, um zu bestätigen, dass die Umstellung der Zuggenerierung tatsächlich zu einer messbaren Reduzierung der Rechenzeit führt. | Mittel |
| **QS-05** | **Überprüfung: Korrektheit der Zugreihenfolge (MVV/LVA)** | Stellen Sie sicher, dass die neue Liste der `noisy` Moves weiterhin nach dem MVV/LVA-Score (`mvvLvaScore`) sortiert wird, da dies für die Effizienz der Alpha-Beta-Suche (Cutoffs) in der Quieszenz-Suche entscheidend ist. | Hoch |